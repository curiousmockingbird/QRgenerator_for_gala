Automatic QR Code Generation & Email (Google Apps Script)

This script automates creating QR codes in Google Sheets and sending them via email. It’s designed for event registrations (like a gala), where each row represents a guest.
How It Works

    Trigger: The onEdit(e) function runs automatically whenever you edit the sheet.
    Processing:
        If a row contains an email address but no QR code (in the last column), the script will generate one.
        It uses a third-party API (api.qrserver.com) to generate the QR code image URL.
        It writes an =IMAGE("...") formula into the last column, so the QR code image appears.
    Email:
        The script sends an HTML email (sendEmailWithQRCode) that embeds the newly generated QR code and includes event details.

Important Columns (Sheet Layout)

    ID (Column A, index 1)
    Name (Column B, index 2)
    Last Name (Column D, index 4)
    Ticket (Column G, index 7)
    Email (Column K, index 11)
    QR Code (Last column in the sheet)

Key Functions

    onEdit(e)
        Main trigger, calls processSheet() whenever the sheet is edited.

    processSheet()
        Loops through rows, checks for a missing QR code in rows that have an email, then generates a code and calls sendEmailWithQRCode().

    generateQRCodeUrl(data)
        Constructs a QR code URL using the api.qrserver.com service.

    sendEmailWithQRCode(email, name, lastName, id, ticket, qrUrl)
        Sends an HTML email with the QR code image and relevant event/guest info.

Setup

    Add Script to Sheet
        Go to Extensions → Apps Script.
        Paste in the code (or use Clasp + GitHub).

    Check Triggers
        By default, onEdit(e) is a simple trigger.
        If needed, set up an installable trigger under Triggers in Apps Script.

    Authorize and Test
        Upon first run, grant permission to send emails.
        Edit a row (with an email in the correct column) and see if a QR code is generated.

Notes

    The script sends emails through MailApp; ensure the address Danielle@voces-wi.org or your chosen “From” address is authorized and correct.
    You can adjust column indices if your sheet layout differs.
    The external QR code API is free but publicly reachable—check any data privacy needs before use.